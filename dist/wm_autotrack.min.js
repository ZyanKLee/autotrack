var wmAutoTrack=function(t){var t=t||{};this.trackDownlodsAsEvents=t.trackDownlodsAsEvents||!1,this.trackDownlodsWithPath=t.trackDownlodsWithPath||!1,this.pathPageDownloads=t.pathPageDownloads||"DL|",this.pathEventDownloads=t.pathEventDownloads||"DL/",this.milestoneDownloads=t.milestoneDownloads||"Downloads",this.trackExtLinksAsEvents=t.trackExtLinksAsEvents||!1,this.trackExtlinksWithPath=t.trackExtlinksWithPath||!1,this.trackExtlinksFullUrl=t.trackExtlinksFullUrl||!1,this.pathPageExtlinks=t.pathPageExtlinks||"ExtLink|",this.pathEventExtlinks=t.pathEventExtlinks||"ExtLinks/",this.milestoneExtlinks=t.milestoneExtlinks||"",this.trackMailtoWithPath=t.trackMailtoWithPath||!1,this.trackMailLinkAsEvents=t.trackMailLinkAsEvents||!1,this.pathPageMailto=t.pathPageMailto||"MailTo|",this.pathEventMailto=t.pathEventMailto||"MailTo/",this.milestoneMailto=t.milestoneMailto||"",this.debug=t.debug||!1,this.revertChangedValues=t.revertChangedValues||!0;var e=this;this.init=function(){for(var t=document.getElementsByTagName("a"),a="",i=window.location.hostname,n=0;n<t.length;n++){var s=t[n];try{var o=s.href,r=s.hostname;if(a=s.pathname,o.match(/^mailto:/i)){e.logme("Tracking "+n+" "+o+" as MailTo");var l=o.split("mailto:"),m=l[1],d="mailto";e.addListener(s,function(t,a){return function(){e.logme("A MAILTO was clicked!"),e.wiredmindsTrack(t,a)}}(d,m))}else if(e.compareDomains(r,i)){if(a.match(/\.(pdf|txt|doc|docx|xls|xlsx|ppt|pptx|js|vsd|vxd|css|rar|zip|tar|gz|dmg|exe|wma|mov|avi|wmv|mp3|mp4|vcf)$/i)){e.logme("Tracking "+n+" "+o+" as DOC");var h="/"+a,c=h.split("/"),k=c[c.length-1],d="download";e.addListener(s,function(t,a){return function(){e.logme("A FILE was clicked!"),e.wiredmindsTrack(t,a)}}(d,k))}}else{e.logme("Tracking "+n+" "+o+" as EXTLINK");var k=r;e.trackExtlinksFullUrl===!0&&(k=o);var d="extlink";e.addListener(s,function(t,a){return function(){e.logme("An ExtLink was clicked!"),e.wiredmindsTrack(t,a)}}(d,k))}}catch(w){e.logme("Tracking error: "+w)}}},this.addListener=function(t,e){t.addEventListener?t.addEventListener("mousedown",e,!0):t.attachEvent&&t.attachEvent("onmousedown",e)},this.wiredmindsTrack=function(t,a){if("undefined"!=typeof wiredminds){if(e.revertChangedValues===!0)try{if("function"==typeof wiredminds.getTrackParam)var i=wiredminds.getTrackParam("wm_page_name"),n=wiredminds.getTrackParam("wm_milestone");else e.logme("Unable to fetch original values for reset, disabling revert."),e.revertChangedValues=!1}catch(s){e.logme("Unable to fetch original values for reset, disabling revert."),e.revertChangedValues=!1}"download"==t&&(e.trackDownlodsAsEvents?wiredminds.push(["trackEvent",e.pathEventDownloads+a]):e.trackDownlodsWithPath?(""!==e.milestoneDownloads&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneDownloads]),wiredminds.push(["count",a])):(wiredminds.push(["setTrackParam","wm_page_name",e.pathPageDownloads+a]),""!==e.milestoneDownloads&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneDownloads]),wiredminds.push(["count"]))),"extlink"==t&&(e.trackExtLinksAsEvents?wiredminds.push(["trackEvent",e.pathEventExtlinks+a]):e.trackExtlinksWithPath?(""!==e.milestoneExtlinks&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneExtlinks]),wiredminds.push(["count",a])):(wiredminds.push(["setTrackParam","wm_page_name",e.pathPageExtlinks+a]),""!==e.milestoneExtlinks&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneExtlinks]),wiredminds.push(["count"]))),"mailto"==t&&(e.trackMailLinkAsEvents?wiredminds.push(["trackEvent",e.pathEventMailto+a]):e.trackMailtoWithPath?(""!==e.milestoneMailto&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneMailto]),wiredminds.push(["count",a])):(wiredminds.push(["setTrackParam","wm_page_name",e.pathPageMailto+a]),""!==e.milestoneMailto&&wiredminds.push(["setTrackParam","wm_milestone",e.milestoneMailto]),wiredminds.push(["count"]))),e.revertChangedValues===!0&&(wiredminds.push(["setTrackParam","wm_page_name",i]),wiredminds.push(["setTrackParam","wm_milestone",n]))}},this.compareDomains=function(t,a){return e.getDomain(t)==e.getDomain(a)},this.getDomain=function(t){var e=t.lastIndexOf(".");e=t.lastIndexOf(".",e-1);var a=t.substring(e+1);return a},this.logme=function(t){1==e.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)}};